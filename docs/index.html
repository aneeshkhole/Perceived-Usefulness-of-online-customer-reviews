<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Patrick Connelly">
<meta name="author" content="Aneesh Khole">
<meta name="author" content="Uttara Ketkar">
<meta name="dcterms.date" content="2024-02-17">

<title>CSCI 5302 - Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data.html" rel="next">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.27.0.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>



</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CSCI 5302 - Final Project</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/pconnell/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./CSCI_5302_Final_Report.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models implemented.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Models Implemented</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conclusions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-intro" id="toc-sec-intro" class="nav-link active" data-scroll-target="#sec-intro"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#concept-and-motivation" id="toc-concept-and-motivation" class="nav-link" data-scroll-target="#concept-and-motivation"><span class="header-section-number">1.1</span> Concept and Motivation</a></li>
  <li><a href="#what-where" id="toc-what-where" class="nav-link" data-scroll-target="#what-where"><span class="header-section-number">1.2</span> What / Where</a></li>
  <li><a href="#why-it-matters" id="toc-why-it-matters" class="nav-link" data-scroll-target="#why-it-matters"><span class="header-section-number">1.3</span> Why It Matters</a></li>
  <li><a href="#literature-survey" id="toc-literature-survey" class="nav-link" data-scroll-target="#literature-survey"><span class="header-section-number">1.4</span> Literature Survey</a></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions"><span class="header-section-number">1.5</span> Research Questions</a></li>
  <li><a href="#goals-definition-of-success" id="toc-goals-definition-of-success" class="nav-link" data-scroll-target="#goals-definition-of-success"><span class="header-section-number">1.6</span> Goals / Definition of Success</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CSCI 5302 - Final Project</h1>
</div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Patrick Connelly </p>
             <p>Aneesh Khole </p>
             <p>Uttara Ketkar </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>



<section id="sec-intro" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1><p><img src="images/cover.png" title="CSCI 5302 - Final Project" class="quarto-cover-image img-fluid"></p>
<section id="concept-and-motivation" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="concept-and-motivation"><span class="header-section-number">1.1</span> Concept and Motivation</h2>
<!--PC-->
<p>Customers, when searching for products with specific features and aspects, need sufficient information to make a decision as to whether to procure a specific product. <em>(Information on search products vs.&nbsp;experience vs.&nbsp;mixed).</em> When a product is more in the directon of experience vs.&nbsp;search-based, other customers’ experiences can shed light on its features and return on investment than information directly from the vendor can. Having reviews from reliable sources with sufficiently detailed information can enable greater confidence in a purchase, improved customer satisfaction, and smooth the process of ecommerce for customers.</p>
<p>We seek to expound upon the research of <em>paper reference here</em> to explore additional recommended research areas, in the direction</p>
</section>
<section id="what-where" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="what-where"><span class="header-section-number">1.2</span> What / Where</h2>
<!-- -->
<p><em>(Citation)</em> provided the following areas for recommended additional research at the conclusion of their paper: <!--PC--></p>
<ul>
<li><p>Expand the number of products beyond 3 items (one search, one experience, one mixed)</p></li>
<li><p>Explore customer metadata for classifying reviewer types <!--Team - I don't know that we can actually go about getting customer metadata.  This may be a bridge too far for us unless the site(s) we identify can provide such information--></p></li>
</ul>
<p>We seek to explore Item #1 and #2 above and explore the possibility of assessing a scale for products to determine the extent to which they are a search-based or an experience-based product. We’ve explored additonal research from other teams to identify additional potential methods</p>
<ul>
<li><!--AK talk about Naive Bayes, Kansei Method--></li>
<li><!--UK - talk about Customer Reliability methods--></li>
</ul>
<p>We seek to examine additional products and product types between multiple e-commerce websites (BestBuy, Target, Amazon).</p>
</section>
<section id="why-it-matters" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="why-it-matters"><span class="header-section-number">1.3</span> Why It Matters</h2>
<!--PC-->
<p>Feedback from customers is beneficial, but it is not always ordered by the most informative or beneficial feedback first. Certain features of data such as… can impact the usefulness of the feedback on a customer-by-customer basis. Level of detail, star-rating, and number of votes that support the review as being useful to a customer can all help determine its usefulness to other customers. Were e-commerce</p>
<p>Examining additional product types can enable the generalization of the authors’ methodology to other products. Furthermore, the exploration of a sliding scale for search vs.&nbsp;experience-based products can further support generalization and business goals. Producing a reliable scale and methods for classifying a products’ degree of being experienced-based can inform vendors on:</p>
<ul>
<li><p>How to best sort product reviews</p></li>
<li><p>Examine what are the most helpful reviews to know the performance of the product alongside customer experience and sentiment</p></li>
<li><p>Adjust the product, its marketing, or future production based upon market efficacy.</p></li>
<li><!--AK talk about Naive Bayes, Kansei Method--></li>
<li><!--UK - talk about Customer Reliability methods--></li>
</ul>
</section>
<section id="literature-survey" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="literature-survey"><span class="header-section-number">1.4</span> Literature Survey</h2>
<ul>
<li><p><strong>Additional commentary on original paper here</strong></p></li>
<li><p><strong>Paper(s) on product classification (search-experience-mixed)</strong></p></li>
<li><p><strong>Paper(s) on user/consumer/reviewer classification</strong> <!--PC, UK, AK--></p></li>
<li><p><strong>All papers you’ve found, provide a summary of what they did and any key results</strong></p></li>
</ul>
</section>
<section id="research-questions" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="research-questions"><span class="header-section-number">1.5</span> Research Questions</h2>
<ul>
<li><p>Can the model from <em>(original paper citation)</em> be generalized with</p>
<ol type="a">
<li><p>larger volume of products and product types?</p></li>
<li><p>a sliding scale weight for degree to which a product is a “search” (0) or “experience” (1) product?</p></li>
<li><p>Adding modifiers to review content based upon:</p>
<ul>
<li>Customer / Reviewer Reliability?</li>
</ul></li>
</ol>
<p><!--AK add bullet(s) on Naive Bayes classifier--></p></li>
<li><p>Can products be classified on degree of search or experience <em>(need other research that can tell us what features of a product determine what makes a product a search vs.&nbsp;experience product)</em> using: <!--PC ---></p>
<ul>
<li><p>Which of the 5 senses the product engages?</p></li>
<li></li>
</ul></li>
</ul>
<!-- 

NEW: true/false.

Discounted / lower price?

Fiction/Non-Fiction book concept?

Rarity: 1-of-a-kind or limited production, vs. bulk produced?

Factory Produced: T/F

Environmentally Friendly? T/F

Touch: t/f

Hear: t/f 

Smell: t/f 

See: t/f (is the primary purpose to look at the item)

Taste: t/f 

ALL (): please list your ideas for true/false variables here

-->
<pre><code>a. Feature 1

b. Feature 2

c. Some combination of features?</code></pre>
<ul>
<li><p>Can different natrual language processing libraries provide a better fit for the Review Content metric itself?</p></li>
<li><!-- AK 2 research questions --></li>
<li><!-- UK 2 research questions --></li>
</ul>
</section>
<section id="goals-definition-of-success" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="goals-definition-of-success"><span class="header-section-number">1.6</span> Goals / Definition of Success</h2>
<!-- -->
<ul>
<li><p>Replicate similar results to <em>(original paper citation)</em> with similar product types</p></li>
<li><p>Expound upon <em>(original paper citation)</em> with additional products, including:</p>
<ol type="a">
<li><p>Original products from (paper): Digital Music, Video Game, and Grocery Item</p></li>
<li><p>Additional products (Amazon and Target): Furniture Items, Clothing Items, Home Appliances, Books, Cosmetics, Cleaning supplies?</p></li>
<li><p>Additional Proucts (Amazon, Target, BestBuy): Electronics.</p></li>
<li><p>Verify goodness of fit of original model</p></li>
</ol></li>
<li><p>Determing best metrics and/or modifiers for Review Content and Customer Reliability</p></li>
<li><p>Achieving similar or better fit than original paper’s modeling; extrapolate to other product types.</p></li>
</ul>
<!-- * Perform analysis of multiple product types to produce a weighting for degree of how experienced-based the product is.

* Assess weighting of products in terms of degree of "experience" base, and use an updated formula on

    a. Original Model

    b. Updated Model

    c. Extrapolation on data outside the models.

* Success of our effort and this methodology is met if it produces as-good or better performance of the experience weight-based model vs. the original model from *(original paper citation here)* -->
<p>This is where our abstract will go.</p>
<p>Here’s an example of inserting a plot directly into our paper</p>
<div id="cell-fig-a" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div id="fig-a" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-a-output-1.png" width="566" height="411" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1: a matplotlib plot
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here’s an example of pulling some data in from our github repo</p>
<div id="a06915fb" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div>                            <div id="e5b07062-3a4c-42df-8be9-25da250463b7" class="plotly-graph-div" style="height:500px; width:1000px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e5b07062-3a4c-42df-8be9-25da250463b7")) {                    Plotly.newPlot(                        "e5b07062-3a4c-42df-8be9-25da250463b7",                        [{"colorbar":{"title":{"text":"alcohol-related fatalities (%)"}},"locationmode":"USA-states","locations":["AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"z":[0.36881762608015495,0.239872927165163,0.49356184525923275,0.2988364040916165,0.32896706586826346,0.3788543701171883,0.3741803403760566,0.3056012098626555,0.3606428079628381,0.2999609410762785,0.3228285828191248,0.36304892263104893,0.45683333079020205,0.5789256881039779,0.33965329358177493,0.3470293389450614,0.45325299917933437,0.27437500953674376,0.5231714552559514,0.35642242431640664,0.28826621033890715,0.3780821917808219,0.37916630091292136,0.3761574752687469,0.3465478831324084,0.3440785816737582,0.46083814146890806,0.25511308934304333,0.28414210909574,0.25294171385363645,0.5248043033954098,0.5320945945945946,0.40020535462527196,0.30465843012482163,0.3154054148316834,0.31945575967865253,0.3028571355910524,0.3008219261692,0.3671621631931615,0.366606624657509,0.4972465944324116,0.2111864380917305,0.25943925447553084,0.28683314069039956,0.3623075026241859,0.32,0.33167791985846234,0.3479154216709423],"type":"choropleth"},{"colorbar":{"title":{"text":"alcohol-related fatalities (%)"}},"locationmode":"USA-states","locations":["AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"z":[0.3675634568737398,0.29168888798466375,0.44498562770001077,0.2736934125488607,0.3364551178073003,0.3909132447961256,0.3,0.35886076858304616,0.3005401234567901,0.3356653945980871,0.32837484017268415,0.34130904430479525,0.4115953259894825,0.4511654522007104,0.3375424186490797,0.38849946540268276,0.4089062554495674,0.27032012474246186,0.34027650425877265,0.3749695520967108,0.3217387431376685,0.17489930266266993,0.3862239364473282,0.39384964629486713,0.2780548993278953,0.2289288486887814,0.3300994753213456,0.24892703862660945,0.2585875660237175,0.2386567175933587,0.2768395422343501,0.6206896551724138,0.47046778084505375,0.27873820178913683,0.30009091463956,0.309947694892595,0.275300006866455,0.32835308635404264,0.26857142857142857,0.3644069572308949,0.4741041067224693,0.2393639500486555,0.36276594121405425,0.29773585989525525,0.33885243150771205,0.36,0.3527958521349683,0.35899999100348845],"type":"choropleth"},{"colorbar":{"title":{"text":"alcohol-related fatalities (%)"}},"locationmode":"USA-states","locations":["AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"z":[0.3271158897825579,0.2443739843862382,0.34801333472842283,0.2832310649978207,0.3337828987523125,0.36609807451650744,0.22061538696289076,0.2645273649192651,0.3097517730496454,0.32917356885169174,0.29882352862268713,0.37994595914273627,0.40164286295572854,0.4091549144071686,0.31388859027892835,0.4240655650953601,0.3094827717748181,0.2800466676892986,0.316171182168497,0.3576290197889451,0.3576563674559708,0.6391752577319587,0.34895035941943536,0.386147058310629,0.22231579161526877,0.23787549796353374,0.3672864437103271,0.22953145984972342,0.2449496938908853,0.21549029303985873,0.2573379411368538,0.58,0.533074120559785,0.27304892737413805,0.26884615171205767,0.28785755928362017,0.31139240989202155,0.35010918363212995,0.35412586985768113,0.3549954349047516,0.4735352685846421,0.24780951605902796,0.27903508303458247,0.2682724676857108,0.3075911493787172,0.3000091483059544,0.3316253142345268,0.396681524386072],"type":"choropleth"},{"colorbar":{"title":{"text":"alcohol-related fatalities (%)"}},"locationmode":"USA-states","locations":["AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"z":[0.31376644489175853,0.2528824245542587,0.37107491939701875,0.2507903314405867,0.32250431041025734,0.3364955357142857,0.3738461641164923,0.24371469357592904,0.2939970645722351,0.28882353539560357,0.2585984370543716,0.3105236264959251,0.38555064784826587,0.47685185185185186,0.28616573033707865,0.38737807391665524,0.2844660120102966,0.25903977549779283,0.2539487771910795,0.27427832347289643,0.2639572243941464,0.5738595000206526,0.3092277026970333,0.42422868531915653,0.2553375501672928,0.2599536792652027,0.38010470405299,0.21106120066029357,0.2472710154880991,0.21157528087125324,0.23301618527143456,0.4015555487738711,0.5455163930195358,0.27443547402658736,0.26899820235632915,0.3205872443622953,0.28165138314623395,0.4206624477318286,0.2684615501990685,0.2945594891540363,0.3999510656691816,0.20894389892175247,0.31608694325322695,0.2753688624647797,0.29325538553217473,0.3336476280575714,0.3307271567724086,0.3443750080309414],"type":"choropleth"},{"colorbar":{"title":{"text":"alcohol-related fatalities (%)"}},"locationmode":"USA-states","locations":["AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"z":[0.3336873297113497,0.24113902269077359,0.3938922028043383,0.2493641793603065,0.29082917929881924,0.3238888888888889,0.334926464978386,0.2851024829877982,0.30269934959660916,0.32565890171731166,0.29803885553116166,0.27968207857282656,0.33328572314342403,0.432028015136718,0.30423106317934784,0.37758904976906227,0.3078504544552243,0.2513775533559375,0.24906915299435906,0.3104735187280959,0.28512257911695443,0.603082995779629,0.31147386332968907,0.31502701355530316,0.27155172413793105,0.30003432245213607,0.2792848764463913,0.1973657396920491,0.24649298597194388,0.20272384197727664,0.24874316495190105,0.310900001525879,0.5043873442053013,0.2537196081595365,0.2850242208009386,0.32656812013265574,0.38016128540039035,0.45834751147161285,0.26932835934767085,0.32169918897675287,0.35528456653437623,0.1755910513880917,0.30660548778848895,0.26137655200585613,0.31610526333153627,0.33147499778054096,0.3427456571075971,0.3443868954976399],"type":"choropleth"},{"colorbar":{"title":{"text":"alcohol-related fatalities (%)"}},"locationmode":"USA-states","locations":["AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"z":[0.3319108017930036,0.2580362847164322,0.3472691686686964,0.2600962838461228,0.2373265558491303,0.3686191414406147,0.286575343510876,0.27438181426668723,0.2942026220611514,0.2983969477296786,0.2633192682840735,0.2415734602941725,0.3790020292014073,0.37562321742537474,0.30314099280190165,0.3670798212902431,0.2583189668326543,0.20885748710913513,0.25550071594504065,0.3051784565542818,0.26745283018867927,0.6142857062122804,0.3110229959889847,0.3327564011272201,0.22859258683843636,0.2624847470349027,0.2972067081728464,0.19965200713186512,0.2823063487737958,0.20567080436016547,0.2231313146726048,0.3998019907734178,0.38639390656964223,0.2477052008087303,0.2331290214292468,0.3260342310467257,0.37654866581469465,0.3478545018542099,0.22417911130990523,0.301578521728516,0.31722783823022077,0.19189188931439358,0.3273109307810042,0.2557296827654417,0.31614231207431925,0.2996900360042633,0.3117540807018018,0.2751937984496124],"type":"choropleth"},{"colorbar":{"title":{"text":"alcohol-related fatalities (%)"}},"locationmode":"USA-states","locations":["AL","AZ","AR","CA","CO","CT","DE","FL","GA","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"z":[0.29161484942990906,0.2523665185702045,0.3423770591860918,0.2313005493390538,0.26750502404072835,0.2797933846465806,0.26775000095367435,0.2582033788174139,0.29333333628724256,0.2832684943648163,0.27591181606070553,0.29282469927019433,0.32684200156740933,0.3344410013708261,0.26831742971779954,0.33899783572635134,0.24223529591279883,0.20205881650490537,0.28168276030441797,0.32343310145704934,0.2582957448523023,0.6232686980609419,0.31810245185360925,0.3693181818181818,0.346796934632049,0.26346502770910735,0.2633493952004307,0.1969238774874006,0.3315605774552423,0.1856230539123131,0.23765415548141514,0.3570192410395692,0.32208736633889334,0.2623659248231719,0.22732643116171936,0.297260491851696,0.3,0.3110251509705184,0.29068026899480476,0.31475514295918483,0.3376451532221662,0.24074074074074073,0.30263566601183955,0.2364519192279776,0.3289691562211298,0.3074760768724522,0.3403680321600062,0.30594839280651487],"type":"choropleth"}],                        {"geo":{"projection":{"type":"albers usa"},"scope":"usa"},"height":500,"sliders":[{"active":6,"pad":{"t":1},"steps":[{"args":["visible",[true,false,false,false,false,false,false]],"label":"1982","method":"restyle"},{"args":["visible",[false,true,false,false,false,false,false]],"label":"1983","method":"restyle"},{"args":["visible",[false,false,true,false,false,false,false]],"label":"1984","method":"restyle"},{"args":["visible",[false,false,false,true,false,false,false]],"label":"1985","method":"restyle"},{"args":["visible",[false,false,false,false,true,false,false]],"label":"1986","method":"restyle"},{"args":["visible",[false,false,false,false,false,true,false]],"label":"1987","method":"restyle"},{"args":["visible",[false,false,false,false,false,false,true]],"label":"1988","method":"restyle"}]}],"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Alcohol-Related Fatality Rate 1982-1988"},"width":1000},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e5b07062-3a4c-42df-8be9-25da250463b7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./data.html" class="pagination-link" aria-label="<span class='chapter-number'>2</span>&nbsp; <span class='chapter-title'>Data</span>">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>